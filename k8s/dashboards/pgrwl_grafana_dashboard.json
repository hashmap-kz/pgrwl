{
  "uid": "pgrwl-dashboard",
  "title": "PGRWL: WAL Receiver Dashboard",
  "tags": [
    "postgres",
    "wal",
    "pgrwl",
    "replication"
  ],
  "timezone": "browser",
  "schemaVersion": 30,
  "version": 1,
  "panels": [
    {
      "type": "stat",
      "title": "WAL Bytes Received",
      "gridPos": {
        "x": 0,
        "y": 0,
        "w": 6,
        "h": 4
      },
      "targets": [
        {
          "expr": "pgrwl_wal_bytes_received_total",
          "format": "time_series"
        }
      ],
      "fieldConfig": {
        "defaults": {
          "unit": "bytes"
        }
      }
    },
    {
      "type": "stat",
      "title": "WAL Segments Received",
      "gridPos": {
        "x": 6,
        "y": 0,
        "w": 6,
        "h": 4
      },
      "targets": [
        {
          "expr": "pgrwl_wal_segments_received_total",
          "format": "time_series"
        }
      ],
      "fieldConfig": {
        "defaults": {
          "unit": "none"
        }
      }
    },
    {
      "type": "stat",
      "title": "Current LSN",
      "gridPos": {
        "x": 12,
        "y": 0,
        "w": 6,
        "h": 4
      },
      "targets": [
        {
          "expr": "pgrwl_wal_stream_lsn_current",
          "format": "time_series"
        }
      ],
      "fieldConfig": {
        "defaults": {
          "unit": "none"
        }
      }
    },
    {
      "type": "graph",
      "title": "LSN Lag (bytes)",
      "gridPos": {
        "x": 18,
        "y": 0,
        "w": 6,
        "h": 4
      },
      "targets": [
        {
          "expr": "pgrwl_wal_stream_lsn_lag_bytes",
          "format": "time_series"
        }
      ],
      "fieldConfig": {
        "defaults": {
          "unit": "bytes"
        }
      }
    },
    {
      "type": "stat",
      "title": "Timeline ID",
      "gridPos": {
        "x": 0,
        "y": 4,
        "w": 6,
        "h": 4
      },
      "targets": [
        {
          "expr": "pgrwl_wal_stream_timeline",
          "format": "time_series"
        }
      ],
      "fieldConfig": {
        "defaults": {
          "unit": "none"
        }
      }
    },
    {
      "type": "graph",
      "title": "Segment Download Duration",
      "gridPos": {
        "x": 6,
        "y": 4,
        "w": 6,
        "h": 4
      },
      "targets": [
        {
          "expr": "histogram_quantile(0.95, sum(rate(pgrwl_wal_segment_download_duration_seconds_bucket[5m])) by (le))",
          "format": "time_series"
        }
      ],
      "fieldConfig": {
        "defaults": {
          "unit": "s"
        }
      }
    },
    {
      "type": "graph",
      "title": "Write Latency",
      "gridPos": {
        "x": 12,
        "y": 4,
        "w": 6,
        "h": 4
      },
      "targets": [
        {
          "expr": "histogram_quantile(0.95, sum(rate(pgrwl_wal_stream_write_latency_seconds_bucket[5m])) by (le))",
          "format": "time_series"
        }
      ],
      "fieldConfig": {
        "defaults": {
          "unit": "s"
        }
      }
    },
    {
      "type": "graph",
      "title": "Flush Latency",
      "gridPos": {
        "x": 18,
        "y": 4,
        "w": 6,
        "h": 4
      },
      "targets": [
        {
          "expr": "histogram_quantile(0.95, sum(rate(pgrwl_wal_stream_flush_latency_seconds_bucket[5m])) by (le))",
          "format": "time_series"
        }
      ],
      "fieldConfig": {
        "defaults": {
          "unit": "s"
        }
      }
    },
    {
      "type": "stat",
      "title": "WAL Disk Usage",
      "gridPos": {
        "x": 0,
        "y": 8,
        "w": 6,
        "h": 4
      },
      "targets": [
        {
          "expr": "pgrwl_wal_disk_usage_bytes",
          "format": "time_series"
        }
      ],
      "fieldConfig": {
        "defaults": {
          "unit": "bytes"
        }
      }
    },
    {
      "type": "stat",
      "title": "Segments Deleted",
      "gridPos": {
        "x": 6,
        "y": 8,
        "w": 6,
        "h": 4
      },
      "targets": [
        {
          "expr": "pgrwl_wal_segments_deleted_total",
          "format": "time_series"
        }
      ],
      "fieldConfig": {
        "defaults": {
          "unit": "none"
        }
      }
    },
    {
      "type": "graph",
      "title": "Retention Duration",
      "gridPos": {
        "x": 12,
        "y": 8,
        "w": 6,
        "h": 4
      },
      "targets": [
        {
          "expr": "histogram_quantile(0.95, sum(rate(pgrwl_wal_retention_run_duration_seconds_bucket[5m])) by (le))",
          "format": "time_series"
        }
      ],
      "fieldConfig": {
        "defaults": {
          "unit": "s"
        }
      }
    },
    {
      "type": "stat",
      "title": "Compression Errors",
      "gridPos": {
        "x": 18,
        "y": 8,
        "w": 6,
        "h": 4
      },
      "targets": [
        {
          "expr": "pgrwl_wal_compression_errors_total",
          "format": "time_series"
        }
      ],
      "fieldConfig": {
        "defaults": {
          "unit": "none"
        }
      }
    },
    {
      "type": "stat",
      "title": "Encryption Errors",
      "gridPos": {
        "x": 0,
        "y": 12,
        "w": 6,
        "h": 4
      },
      "targets": [
        {
          "expr": "pgrwl_wal_encryption_errors_total",
          "format": "time_series"
        }
      ],
      "fieldConfig": {
        "defaults": {
          "unit": "none"
        }
      }
    },
    {
      "type": "stat",
      "title": "WAL Stream Errors",
      "gridPos": {
        "x": 6,
        "y": 12,
        "w": 6,
        "h": 4
      },
      "targets": [
        {
          "expr": "pgrwl_wal_stream_errors_total",
          "format": "time_series"
        }
      ],
      "fieldConfig": {
        "defaults": {
          "unit": "none"
        }
      }
    },
    {
      "type": "stat",
      "title": "Server Disconnects",
      "gridPos": {
        "x": 12,
        "y": 12,
        "w": 6,
        "h": 4
      },
      "targets": [
        {
          "expr": "pgrwl_wal_pg_server_disconnects_total",
          "format": "time_series"
        }
      ],
      "fieldConfig": {
        "defaults": {
          "unit": "none"
        }
      }
    },
    {
      "type": "stat",
      "title": "Reconnection Attempts",
      "gridPos": {
        "x": 18,
        "y": 12,
        "w": 6,
        "h": 4
      },
      "targets": [
        {
          "expr": "pgrwl_wal_pg_connection_retries_total",
          "format": "time_series"
        }
      ],
      "fieldConfig": {
        "defaults": {
          "unit": "none"
        }
      }
    },
    {
      "type": "stat",
      "title": "App Uptime",
      "gridPos": {
        "x": 0,
        "y": 16,
        "w": 6,
        "h": 4
      },
      "targets": [
        {
          "expr": "pgrwl_app_uptime_seconds",
          "format": "time_series"
        }
      ],
      "fieldConfig": {
        "defaults": {
          "unit": "s"
        }
      }
    },
    {
      "type": "stat",
      "title": "Goroutines",
      "gridPos": {
        "x": 6,
        "y": 16,
        "w": 6,
        "h": 4
      },
      "targets": [
        {
          "expr": "pgrwl_goroutines",
          "format": "time_series"
        }
      ],
      "fieldConfig": {
        "defaults": {
          "unit": "none"
        }
      }
    }
  ]
}